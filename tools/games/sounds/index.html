<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sound Letters</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            position: relative;
            overflow: hidden;
            background-color: #f0f0f0;
        }

        .letter {
            position: absolute;
            font-size: 8vw;
            cursor: pointer;
            white-space: nowrap;
            transform-origin: center;
            user-select: none;
            touch-action: none;
            transition: transform 0.2s ease;
        }

        .switch-container {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1;
            display: flex;
            align-items: center;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            border-radius: 50%;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: 0.4s;
        }

        input:checked + .slider {
            background-color: #4caf50;
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .label {
            margin-left: 10px;
        }

        @media (max-width: 768px) {
            .letter {
                font-size: 12vw; /* Adjust font size for smaller devices */
            }
        }
    </style>
</head>
<body>

    <div class="switch-container">
        <label class="switch">
            <input type="checkbox" id="sound-toggle" checked>
            <span class="slider"></span>
        </label>
        <span class="label">Allow Sound</span>
    </div>

    <script>
        const soundFiles = {
            a: ['sounds/a.mp3', 'sounds/a.webm'],
            b: ['sounds/b.mp3', 'sounds/b.webm'],
            c: ['sounds/c.mp3', 'sounds/c.webm'],
            d: ['sounds/d.mp3', 'sounds/d.webm'],
            e: ['sounds/e.mp3', 'sounds/e.webm'],
            f: ['sounds/f.mp3', 'sounds/f.webm'],
            g: ['sounds/g.mp3', 'sounds/g.webm'],
            h: ['sounds/h.mp3', 'sounds/h.webm'],
            i: ['sounds/i.mp3', 'sounds/i.webm'],
            j: ['sounds/j.mp3', 'sounds/j.webm'],
            k: ['sounds/k.mp3', 'sounds/k.webm'],
            l: ['sounds/l.mp3', 'sounds/l.webm'],
            m: ['sounds/m.mp3', 'sounds/m.webm'],
            n: ['sounds/n.mp3', 'sounds/n.webm'],
            o: ['sounds/o.mp3', 'sounds/o.webm'],
            p: ['sounds/p.mp3', 'sounds/p.webm']
            // Add more sounds if necessary
        };

        let isSoundEnabled = true;

        // Toggle sound on/off based on user preference
        const soundToggle = document.getElementById('sound-toggle');
        soundToggle.addEventListener('change', (event) => {
            isSoundEnabled = event.target.checked;
        });

        function playSound(letter) {
            if (isSoundEnabled) {
                const soundFilesForLetter = soundFiles[letter];
                let audioPlayed = false;

                // Trigger an alert to force user interaction
                alert('Sound will play now!');
                
                soundFilesForLetter.forEach(file => {
                    const audio = new Audio(file);
                    audio.play().then(() => {
                        audioPlayed = true;
                    }).catch(error => {
                        console.log(`Error playing sound ${file}:`, error);
                    });
                });

                // Fallback if no audio played
                if (!audioPlayed) {
                    console.log(`No audio played for ${letter}`);
                }
            }
        }

        function getRandomPosition(letterWidth, letterHeight) {
            const maxX = window.innerWidth - letterWidth;
            const maxY = window.innerHeight - letterHeight;
            return {
                x: Math.random() * maxX,
                y: Math.random() * maxY
            };
        }

        function getRandomRotation() {
            return Math.random() * 360; // Random rotation between 0-360 degrees
        }

        function isOverlapping(rect1, rect2) {
            return !(rect1.right < rect2.left || 
                     rect1.left > rect2.right || 
                     rect1.bottom < rect2.top || 
                     rect1.top > rect2.bottom);
        }

        function displayLetters() {
            const body = document.body;
            const keys = Object.keys(soundFiles);
            const letterWidth = 120; // Approximate width of each letter
            const letterHeight = 120; // Approximate height of each letter
            const letters = [];

            keys.forEach(letter => {
                let position, overlaps;

                // Prevent letters from overlapping
                do {
                    position = getRandomPosition(letterWidth, letterHeight);
                    const newRect = {
                        left: position.x,
                        top: position.y,
                        right: position.x + letterWidth,
                        bottom: position.y + letterHeight
                    };
                    overlaps = letters.some(({ rect }) => isOverlapping(rect, newRect));
                } while (overlaps);

                const letterElement = document.createElement('div');
                letterElement.textContent = letter.toUpperCase();
                letterElement.className = 'letter';
                letterElement.style.left = `${position.x}px`;
                letterElement.style.top = `${position.y}px`;
                letterElement.style.transform = `rotate(${getRandomRotation()}deg)`;

                // Add both click and touchend event listeners
                letterElement.addEventListener('click', () => playSound(letter));
                letterElement.addEventListener('touchend', (event) => {
                    event.preventDefault(); // Prevent default touch behavior (like scrolling)
                    playSound(letter);
                });

                body.appendChild(letterElement);

                letters.push({
                    element: letterElement,
                    rect: {
                        left: position.x,
                        top: position.y,
                        right: position.x + letterWidth,
                        bottom: position.y + letterHeight
                    }
                });
            });
        }

        window.addEventListener('resize', () => {
            document.body.innerHTML = ''; // Clear the screen
            displayLetters(); // Redraw the letters
        });

        document.addEventListener('DOMContentLoaded', displayLetters);
    </script>

</body>
</html>
